C51 COMPILER V9.52.0.0   MAIN                                                              08/17/2016 10:12:55 PAGE 1   


C51 COMPILER V9.52.0.0, COMPILATION OF MODULE MAIN
OBJECT MODULE PLACED IN ..\OUT\main.obj
COMPILER INVOKED BY: C:\Program Files\kile\C51\BIN\C51.EXE ..\SRC\main.c LARGE OMF2 BROWSE INCDIR(..\INC;..\PRO;..\SRC) 
                    -DEBUG PRINT(.\main.lst) TABS(2) OBJECT(..\OUT\main.obj)

line level    source

   1          /**********************************************
   2          *  CPU:STC12W1K16S
   3          *  ¾§Õñ:11.0592MHZ
   4          ------------------------------------------------*/
   5          
   6          #define  MAIN_GLOBAL
   7          #include "include.h"
   8          volatile unsigned short timerc;
   9          volatile OS_SYS sys;
  10          
  11          ///////////////////////////////È«¾Ö±äÁ¿/////////////////////////////////////
  12          
  13          unsigned char code rc_data[16] ={0x12,0x34,0x56,0x78,0xED,0xCB,0xA9,0x87,0x12,0x34,0x56,0x78,0x01,0xFE,0x0
             -1,0xFE};//
  14          //M1¿¨µÄÄ³Ò»¿éÐ´ÎªÈçÏÂ¸ñÊ½£¬Ôò¸Ã¿éÎªÇ®°ü£¬¿É½ÓÊÕ¿Û¿îºÍ³äÖµÃüÁî
  15          //4×Ö½Ú½ð¶î£¨µÍ×Ö½ÚÔÚÇ°£©£«4×Ö½Ú½ð¶îÈ¡·´£«4×Ö½Ú½ð¶î£«1×Ö½Ú¿éµØÖ·£«1×Ö½Ú¿éµØÖ·È¡·´£«1×Ö½Ú¿éµØÖ·£«1×Ö½Ú¿éµØÖ
             -·È¡·´ 
  16          unsigned char code DefaultKey[6] = {0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF}; //Ô­Ê¼ÃÜÂë
  17          unsigned char code DefaultKeyA[6] = {7,7,7,7,7,7}; //ÃÜÂëA
  18          unsigned char code DefaultKeyB[6] = {8,8,8,8,8,8}; //ÃÜÂëB
  19          //volatile UINT8   digital_led_refresh = OFF;
  20                                                                          //ÆäÊý¾Ý¶¼»¹Ã»±»²É¼¯ÉÏÈ¥£¬ÔòÀ¶É«ÉÁË¸£©£»
  21          volatile UINT8 led_flash_NO =LED_RED;         //µÆ×é¿ØÖÆ
  22          volatile UINT16 led_flash_period=1000;          //ÉÁË¸ÖÜÆÚ¿ØÖÆ
  23          volatile UINT8 led_flash_mode =LED_FLASH_MODE_1V1;    //ÁÁÃðÊ±¼ä±ÈÀý¿ØÖÆ:0³£ÁÁ
  24          volatile UINT8 led_flash_status = 0;          //ÉÁË¸¿ØÖÆµÆÊ±£¬µÆµ±Ç°µÄ×´Ì¬,0¡ª¡ªÃð£»1¡ª¡ªÁÁ
  25          volatile UINT8 led_flash_NO_BK =LED_RED;        //µÆ×é¿ØÖÆ±¸·ÝÊý¾Ý(À­½ø¶ÈÌõºóÊ¹ÓÃ)
  26          
  27          //Î´Íê³ÉÈÎÎñ¿é
  28          volatile UINT8 beSettingAddr = 0;           //0:·ÇÉèÖÃÕ¾Ö·    1:ÉèÖÃÕ¾Ö·    2£ºÕ¾Ö·Éè¶¨ÒÑ¾­°´ÏÂOK¼ü
  29          volatile UINT8 toSettedAddr[3];             //´ýÉè¶¨µØÖ·Öµ
  30          
  31          volatile UINT8 SystemLocked = OFF;            //Ëø¶¨ÏµÍ³¡¢½âËøÏµÍ³
  32             
  33          ///////////////////////////////È«¾Ö±äÁ¿-END-////////////////////////////////
  34           
  35          ////////////////////////////////////////////////////////////////////////////////
  36          // ¹¦ÄÜÃèÊö : main program
  37          // ÊäÈë²ÎÊý : 
  38          // ·µ»Ø²ÎÊý : 
  39          // ËµÃ÷     :  
  40          ////////////////////////////////////////////////////////////////////////////////
  41          int main(void) 
  42          {   
  43   1        DelayMs(20);    //µÈ´ýµçÔ´ÎÈ¶¨        
  44   1      
  45   1        EA = 0;
  46   1        IO_Init();
  47   1        InitT0();
  48   1      
  49   1        LoadParaInEeprom();
  50   1        baudrate   = BD_9600;
  51   1      
  52   1        UART485_Init(); //¹Ì¶¨Ê¹ÓÃ38400²¨ÌØÂÊ    
C51 COMPILER V9.52.0.0   MAIN                                                              08/17/2016 10:12:55 PAGE 2   

  53   1        PcdReset();
  54   1        PcdAntennaOff(); 
  55   1        PcdAntennaOn(); 
  56   1        Start_Init();
  57   1        EA = 1;//Ê¹ÄÜÖÐ¶Ï   
  58   1        RC_WorkeMode=RC_ReadMode;       
  59   1        while(1)
  60   1        { 
  61   2      
  62   2          if(RC_WorkeMode==RC_WriteMode)//Ð´Ä£Ê½  /**************RFID¿¨¶ÁÐ´¿ØÖÆ***********************/
  63   2             M1_WriteDate(PICC_AUTHENT1A,8,rc_data,DefaultKey); //Ð´IC¿¨
  64   2          else if(RC_WorkeMode==RC_ReadMode)//¶ÁÄ£Ê½
  65   2             M1_Read(PICC_AUTHENT1A ,7,16,DefaultKey);//É¨Ãè¶ÁIC¿¨
  66   2          else if(RC_WorkeMode==RC_ChangeMode)//¶ÁÄ£Ê½//¸ÄÃÜÂë
  67   2             M1_ChangeKey(7);
  68   2      
  69   2          CMD_led_flash();      /**************RGB¿ØÖÆ***********************/
  70   2      
  71   2          CMD_LigheTower_flash(); /********************µÆËþ¿ØÖÆ****************/
  72   2      
  73   2          Scan_Keyboard();      /*************°´¼ü´¦Àí(ÓÐ°´¼üÊ±)*************/
  74   2          if (keyStatus != CMD_KEY_NULL) 
  75   2          {
  76   3            Process_Keyboard();
  77   3          }
  78   2      
  79   2          if (uart.rFlag == ON)   /*************´¦Àí485Í¨Ñ¶********************/
  80   2          {
  81   3            Send485SeriaDate((UINT8 *)uart.rBuffer, uart.rIndex);   //´®¿Ú´òÓ¡½ÓÊÕµ½µÄÊý¾Ý
  82   3            Cmd_Process();
  83   3            uart.rFlag   = OFF;
  84   3            uart.rIndex  = 0;
  85   3          }
  86   2        }                 
  87   1      }
  88          //////////////////////////////////////////////////////////////////////////////////
  89          //// ¹¦ÄÜÃèÊö : ¶¨Ê±Æ÷ÖÐ¶ÏÈë¿Ú
  90          //// ÊäÈë²ÎÊý : 
  91          //// ·µ»Ø²ÎÊý : 
  92          //// ËµÃ÷     :  
  93          //////////////////////////////////////////////////////////////////////////////////
  94          void timer0_int (void) interrupt 1
  95          { 
  96   1        char index = 0;
  97   1        TH0  = TH0_INIT;
  98   1        TL0  = TL0_INIT;
  99   1        if(con_flag==ON)
 100   1        {
 101   2          if(rc_blink_read>0)   //¶Á¿¨»òÕßÐ´¿¨³É¹¦ºóÖ¸Ê¾µÆÁÁ
 102   2          {
 103   3            rc_blink_read--;
 104   3            led_on();
 105   3            BEEP_ON;
 106   3          }
 107   2          else
 108   2          {
 109   3            led_off();
 110   3            BEEP_OFF;
 111   3          }
 112   2        }
 113   1      
 114   1          //´®¿Ú1-485»º³åÇøÓÐÊý¾Ý
C51 COMPILER V9.52.0.0   MAIN                                                              08/17/2016 10:12:55 PAGE 3   

 115   1          if (uart.rIndex != 0)       
 116   1          {
 117   2              if (uart.rTimer-- == 0) 
 118   2              {
 119   3                  uart.rFlag  = ON;
 120   3              }
 121   2          }
 122   1         
 123   1          //µÝ¼õ¼ÆËãÆ÷£¬×Ô¼õ1 ÓÃÓÚRGBÉÁË¸ÖÜÆÚ
 124   1          if (sys.led_flash_count != 0)
 125   1              sys.led_flash_count--;
 126   1          
 127   1          for(index = 0; index < 10; index++)
 128   1          {
 129   2             if(LightTowerCtl[index].led_flash_count > 0)
 130   2                LightTowerCtl[index].led_flash_count--;
 131   2          }
 132   1      
 133   1      }
 134          /*******************************************************************************
 135                          END         
 136          *******************************************************************************/
 137          


MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =    427    ----
   CONSTANT SIZE    =     34    ----
   XDATA SIZE       =     33       1
   PDATA SIZE       =   ----    ----
   DATA SIZE        =   ----    ----
   IDATA SIZE       =   ----    ----
   BIT SIZE         =   ----    ----
   EDATA SIZE       =   ----    ----
   HDATA SIZE       =   ----    ----
   XDATA CONST SIZE =   ----    ----
   FAR CONST SIZE   =   ----    ----
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)
